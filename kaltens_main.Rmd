---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidycensus)
library(tidyverse)
library(tmap)
library(sf)
library(janitor)

options(tigris_use_cache = TRUE)

census_api_key("72ced2515c5a0d9cc250f2fd9772b7cc36aad262", overwrite = TRUE)
```

Required Census codes for demographic variables. Selection is based on most popular demographic values:

Age; Gender; Ethnicity; Income; Level of education; Religion; Occupation; Family structure


- **B01002_001**    Age distribution in D.C.

- **B19013_001**    Median household income distribution in D.C.

- **B02001_001**    Race distribution in D.C.


```{r}
v19 <- load_variables(2019, "acs5", cache = TRUE) %>%
  filter(str_detect(str_to_lower(label),"population"))
```

## Age Distribution in D.C.

```{r}
df_age <- get_acs(geography = "tract", variables = "B01002_001",
state = "DC", geometry = TRUE) %>% clean_names()
plot(df_age["estimate"])
```

## Median Income Distribution in D.C.

```{r}
df_income <- get_acs(geography = "tract", variables = "B19013_001",
state = "DC", geometry = TRUE) %>% clean_names()
plot(df_income["estimate"])

```

## Race Distribution in D.C.

```{r}
df_race <- get_acs(geography = "tract", variables = "B02001_001",
state = "DC", geometry = TRUE) %>% clean_names()
plot(df_race["estimate"])
```

```{r}
df_cencus=get_acs(geography = "tract",
                  variables=c("median_inc"="B06011_001",
                              "age"="B01002_001",
                              "pop"="B01001_001",
                              "pop_black"="B02009_001"),
                  state="DC",geometry=TRUE,year=2018) 
```

```{r}
class(df_cencus)
plot(df_cencus)

df_cens=df_cencus %>% select(-moe) %>% spread(variable,estimate) %>% clean_names()
tm_shape(df_cens) +tm_polygons("age",alpha=.5)
```